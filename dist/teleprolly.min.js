/*! teleprolly - v0.1.0 - 2013-06-11
* https://github.com/marcoscaceres/teleprolly
* Copyright (c) 2013 Marcos Caceres; Licensed MIT */
!function(){"use strict";require.config({paths:{deps:"../deps",DOM:"../deps/DOM",WebIDL:"../webidl/lib/WebIDL","deps/webidlParser":"../webidl/deps/webidlParser","DOM/Futures":"../deps/DOM/Futures","DOM/EventHandler":"../deps/DOM/EventHandler","DOM/EventTarget":"../deps/DOM/EventTarget",async:"../deps/require-plugins/async",goog:"../deps/require-plugins/goog",json:"../deps/require-plugins/json",noext:"../deps/require-plugins/noext",propertyParser:"../deps/sync/propertyParser"}}),define("Futures",["DOM/Futures"],function(){return window.Future}),define("Geocoder",["async!http://maps.google.com/maps/api/js?v=3&sensor=false"],function(){return new window.google.maps.Geocoder}),require(["interfaces/Navigator"])}(),define(["WebIDL","interfaces/TelephonyManager"],function(){"use strict";var a=require("WebIDL"),b=require("interfaces/TelephonyManager"),c=function(){return b},d=!0,e=!1,f={};"navigator"in window&&!("telephony"in navigator)&&a.implementAttr(window.navigator,"telephony",d,e,c,void 0,f)}),define(["Futures","support/EmergencyNumbers","support/Dialer","DOM/EventTarget","DOM/EventHandler","WebIDL/types/Byte","WebIDL/types/DOMString","WebIDL/types/Boolean","Geocoder"],function(a,b,c){"use strict";function d(a){q=navigator.geolocation.watchPosition(e),e(a)}function e(a){var b=new window.google.maps.LatLng(a.coords.latitude,a.coords.longitude);g(b)}function f(a){for(var b,c=a.length-1;c>=0;c--){b=a[c];for(var d,e=b.address_components.length-1;e>=0;e--){d=b.address_components[e];for(var f,g=d.types.length-1;g>=0;g--)if(f=d.types[g],"country"===f)return b.address_components[0].short_name}}}function g(a){o.geocode({latLng:a},function(a,c){var d,e;if(c===window.google.maps.GeocoderStatus.OK){if(d=f(a)){e=b.findByCountry(d);for(var g=p.length-1;g>=0;g--)if(p[g]===e)return;p.splice(0,0,e)}}else alert("Geocoder failed due to: "+c)})}function h(){l.call(this)}function i(){return p}function j(a){c.dial(a)}var k,l=require("DOM/EventTarget"),m=require("DOM/EventHandler"),n=require("WebIDL"),o=require("Geocoder"),p=b.UNIVERSAL_NUMBERS,q=0;return h.prototype=new l,n.implementAttr(h.prototype,"emergencyNumbers",!0,!1,i,void 0,{}),n.implementOperation(h.prototype,"dial",j),n.exportInterface(h,"TelephonyManager"),k=new h,m.implement(k,"onincoming"),m.implement(k,"oncallschanged"),m.implement(k,"onserviceadded"),m.implement(k,"onserviceremoved"),navigator.geolocation.getCurrentPosition(d),window.Dialer=c,k}),define(function(){"use strict";function a(){}function b(){var a=h[g.shift()],b=d.currentTime;a&&(e.forEach(function(c,d){var e=a[d];c.type="sine",c.frequency.setValueAtTime(e,b),c.connect(f),c.start(0)}),setTimeout(c,i.duration))}function c(){e.forEach(function(a){a.disconnect()}),g.length&&setTimeout(b,i.pause)}var d="webkitAudioContext"in window?new webkitAudioContext:null,e=d?[d.createOscillator(),d.createOscillator()]:[],f=d?d.destination:null,g=[],h={1:[1209,697],2:[1336,697],3:[1477,697],A:[1633,697],4:[1209,770],5:[1336,770],6:[1477,770],B:[1633,770],7:[1209,852],8:[1336,852],9:[1477,852],C:[1633,852],"*":[1209,941],0:[1336,941],"#":[1477,941],D:[1633,941],T:[350,440]},i={pause:"120",duration:"500"};return a.prototype.dial=function(a){if("string"==typeof a&&(a=a.split("")),Array.isArray(a)){for(var c,d=0,e=a.length;e>d;d++){if(c=a[d],!c)throw new TypeError("invalid number");g.push(c)}return g.length&&b(),void 0}throw new TypeError},new a}),define(function(){"use strict";function a(){}function b(a){return d[a]||null}var c=["112","911","118","119","000","110","08","999"],d={AF:"???",AL:"???",DZ:"???",AS:"???",AD:"???",AO:"???",AI:"???",AQ:"???",AG:"???",AR:"???",AM:"???",AW:"???",AU:"???",AT:"???",AZ:"???",BS:"???",BH:"???",BD:"???",BB:"???",BY:"???",BE:"???",BZ:"???",BJ:"???",BM:"???",BT:"???",BO:"???",BA:"???",BW:"???",BV:"???",BR:"???",IO:"???",VG:"???",BN:"???",BG:"???",BF:"???",BI:"???",KH:"???",CM:"???",CA:"???",CV:"???",KY:"???",CF:"???",TD:"???",CL:"???",CN:"???",CX:"???",CC:"???",CO:"???",KM:"???",CD:"???",CG:"???",CK:"???",CR:"???",CI:"???",CU:"???",CY:"???",CZ:"???",DK:"???",DJ:"???",DM:"???",DO:"???",EC:"???",EG:"???",SV:"???",GQ:"???",ER:"???",EE:"???",ET:"???",FO:"???",FK:"???",FJ:"???",FI:"???",FR:"???",GF:"???",PF:"???",TF:"???",GA:"???",GM:"???",GE:"???",DE:"???",GH:"???",GI:"???",GR:"???",GL:"???",GD:"???",GP:"???",GU:"???",GT:"???",GN:"???",GW:"???",GY:"???",HT:"???",HM:"???",VA:"???",HN:"???",HK:"???",HR:"???",HU:"???",IS:"???",IN:"???",ID:"???",IR:"???",IQ:"???",IE:"???",IL:"???",IT:"???",JM:"???",JP:"???",JO:"???",KZ:"???",KE:"???",KI:"???",KP:"???",KR:"???",KW:"???",KG:"???",LA:"???",LV:"???",LB:"???",LS:"???",LR:"???",LY:"???",LI:"???",LT:"???",LU:"???",MO:"???",MK:"???",MG:"???",MW:"???",MY:"???",MV:"???",ML:"???",MT:"???",MH:"???",MQ:"???",MR:"???",MU:"???",YT:"???",MX:"???",FM:"???",MD:"???",MC:"???",MN:"???",MS:"???",MA:"???",MZ:"???",MM:"???",NA:"???",NR:"???",NP:"???",AN:"???",NL:"???",NC:"???",NZ:"???",NI:"???",NE:"???",NG:"???",NU:"???",NF:"???",MP:"???",NO:"???",OM:"???",PK:"???",PW:"???",PS:"???",PA:"???",PG:"???",PY:"???",PE:"???",PH:"???",PN:"???",PL:"???",PT:"112",PR:"???",QA:"???",RE:"???",RO:"???",RU:"???",RW:"???",SH:"???",KN:"???",LC:"???",PM:"???",VC:"???",WS:"???",SM:"???",ST:"???",SA:"???",SN:"???",CS:"???",SC:"???",SL:"???",SG:"???",SK:"???",SI:"???",SB:"???",SO:"???",ZA:"???",GS:"???",ES:"???",LK:"???",SD:"???",SR:"???",SJ:"???",SZ:"???",SE:"???",CH:"???",SY:"???",TW:"???",TJ:"???",TZ:"???",TH:"???",TL:"???",TG:"???",TK:"???",TO:"???",TT:"???",TN:"???",TR:"???",TM:"???",TC:"???",TV:"???",VI:"???",UG:"???",UA:"???",AE:"???",GB:"???",UM:"???",US:"???",UY:"???",UZ:"???",VU:"???",VE:"???",VN:"???",WF:"???",EH:"???",YE:"???",ZM:"???",ZW:"???"};return a.prototype.findByCountry=b,Object.defineProperty(a.prototype,"UNIVERSAL_NUMBERS",{get:function(){return c}}),new a});